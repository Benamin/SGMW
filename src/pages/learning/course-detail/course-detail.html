<ion-header>
    <ion-navbar>
        <ion-title>{{product.detail?.TeachTypeName == "直播" ? "直播" : "课程"}}详情</ion-title>
    </ion-navbar>
</ion-header>

<ion-content>
    <div ion-fixed class="fixed-top">
        <div #banner class="banner">
            <div class="background-image">
                <img [src]="product.detail?.ImageUrl" alt="">
            </div>
            <div class="content" *ngIf="product.videoSrc == null">
                <div class="content-info">
                    <div class="course-name">
                        {{product.detail?.Title}}
                    </div>
                    <div class="course-button">
                        <div tappable *ngIf="!product.detail?.IsBuy" (click)="sign()">
                            立即报名
                        </div>
                        <div tappable *ngIf="product.detail?.IsBuy && product.detail?.overpercentage == 100"
                             (click)="studyNow()">
                            回顾{{product.detail?.TeachTypeName == "直播" ? "直播" : "课程"}}
                        </div>
                        <div tappable *ngIf="product.detail?.IsBuy && product.detail?.overpercentage != 100"
                             (click)="studyNow()">
                            立即学习
                        </div>
                    </div>
                    <div class="course-desc" style="margin: 15px auto;">
                    <span>学习截止:
                        {{product.detail?.EndTime | date:'yyyy-MM-dd'}}
                    </span>
                        <span>
                        <img src="./assets/imgs/learn/person@2x.png" alt="">{{product.detail?.ManCount || "0"}}
                            人报名</span>
                    </div>
                    <div class="course-desc">
                    <span>  <!--点赞-->
                        <img tappable (click)="savePraise()" *ngIf="!product.detail?.IsPraise"
                             src="./assets/imgs/course/hua@2x.png" alt="">
                        <img tappable (click)="cancelPraise()" *ngIf="product.detail?.IsPraise"
                             src="./assets/imgs/course/hua_y@2x.png" alt="">
                        {{product.detail?.ZanCount || "0"}}
                    </span>
                        <span>  <!--扔鸡蛋-->
                        <img tappable (click)="saveHate()" *ngIf="!product.detail?.IsHate"
                             src="./assets/imgs/course/jd@2x.png" alt="">
                        <img tappable (click)="cancelHate()" *ngIf="product.detail?.IsHate"
                             src="./assets/imgs/course/jd_y@2x.png" alt="">
                            {{product.detail?.HateCount || "0"}}
                    </span>
                        <span>  <!--收藏-->
                        <img tappable (click)="saveCollection()" *ngIf="!product.detail?.IsCollection"
                             src="./assets/imgs/course/sc@2x.png" alt="">
                        <img tappable (click)="cancleCollection()" *ngIf="product.detail?.IsCollection"
                             src="./assets/imgs/course/sc_y@2x.png" alt="">
                            {{product.detail?.CollectionCount || "0"}}</span>
                    </div>
                </div>
            </div>
            <div id="videoTag" class="content video" [hidden]="product.videoSrc == null">
                <videojs [src]="product.videoSrc" [poster]="product.videoPoster"></videojs>
            </div>
        </div>
        <navbar #navbar [select]="bar.type" [list]="navbarList" (done)="changeType($event)"></navbar>
    </div>
    <div style="margin-top: 236px" #space class="space"></div>

    <ion-slides (ionSlideDidChange)="slideChanged()">
        <ng-container *ngIf="isLoad">
            <!--      简介      -->
            <ion-slide>
                <div class="item">
                    <p>简介</p>
                    <div class="introduction">
                        {{product.detail?.Description}}
                    </div>
                </div>
            </ion-slide>
            <!--      章节      -->
            <ion-slide>
                <div id="chapter" class="item" style="min-height: 350px">
                    <p>章节</p>
                    <div class="chapter">
                        <ng-container *ngFor="let item of product.chapter?.Course?.children">
                            <p tappable (click)="getMore(item)">
                                {{item.title}}
                                <ion-icon *ngIf="item.children.length > 0 && !item.show" class="more-icon"
                                          name="arrow-forward"></ion-icon>
                                <ion-icon *ngIf="item.children.length > 0 && item.show" class="more-icon"
                                          name="arrow-down"></ion-icon>
                            </p>
                            <div *ngIf="item.show" class="chapter-teacher">
                                <div>
                                    <img src="./assets/imgs/home/goodTeacher.png" alt="">
                                </div>
                                <div>{{item.UserName}}</div>
                                <div>
                                    上课时间：{{item.StartTime | date:"yyyy-MM-dd"}}至{{item.EndTime | date:"yyyy-MM-dd"}}
                                </div>
                            </div>
                            <div *ngIf="item.children && item.show">
                                <tree-list
                                        [treeList]="item.children"
                                        [IsBuy]="product.detail?.IsBuy"
                                        [TeachTypeName]="product.detail?.TeachTypeName"
                                ></tree-list>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </ion-slide>
            <!--      讨论      -->
            <ion-slide>
                <div class="item" style="min-height: 350px">
                    <p>{{product.detail?.TeachTypeName == "直播" ? "直播" : "课程"}}讨论
                        <span *ngIf="comment.talk.length > 0" tappable (click)="goCourseDiscuss()" float-end
                              class="look">更多</span>
                        <span *ngIf="comment.talk.length == 0" tappable (click)="goCourseDiscuss()"
                              class="focus focus-blue">去讨论</span>
                    </p>
                    <div class="comment-list">
                        <div class="comment-item" *ngFor="let item of comment.talk;">
                            <div class="first">
                                <div class="headPhoto">
                                    <img [src]="item.HeadPhoto" alt="">
                                </div>
                                <div style="text-align: left">
                                    <p class="badge">
                                        <span>
                                            {{item.UserName}}
                                        </span>
                                        <span *ngIf="item?.TitleInfo?.ForumTitle" class="forumTitle">
                                            {{item?.TitleInfo?.ForumTitle}}
                                        </span>
                                        <span class="badgeSpan" *ngFor="let badge of item?.Badges">
                                            <img [src]="badge.BadgeIcon">
                                            <span>{{badge.BadgeName.length > 4 ? badge.BadgeName.slice(0,4) + '...' : badge.BadgeName}}</span>
                                        </span>
                                    </p>
                                    <p>
                                        <span>{{item.CreateTime | date:'yyyy-MM-dd'}}</span>
                                    </p>
                                </div>
                            </div>
                            <div class="last teacher">
                                <div class="Contents">
                                    {{item.Contents}}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="no-comment" *ngIf="comment.talk.length == 0">
                        <ion-list text-center style="margin-top: 40px">
                            <img style="width: 60%;" src="./assets/imgs/no-data.png" alt="">
                            <p style="color: #666666;font-size: 13px">
                                暂无{{product.detail?.TeachTypeName == "直播" ? "直播" : "课程"}}讨论，快去发一条吧～</p>
                        </ion-list>
                    </div>
                </div>
            </ion-slide>
            <!--      讲师      -->
            <ion-slide>
                <div class="item">
                    <p>讲师
<!--                        <span  tappable float-end class="look">查看</span>-->
                    </p>
                    <div class="sale-box">
                        <div class="scroll-tab">
                            <div class="sale-content">
                                <div class="teacher-info" *ngFor="let item of  teacherList" [ngStyle]="{'width' : teacherList.length>1?'60%':'100%'}">
                                    <div class="teacher-item" (click)="teachDetail(item)">
                                        <div class="img">
                                            <img [src]="item.HeadPhoto  || defalutPhoto">
                                        </div>
                                        <div class="position">
                                            <p>{{item.UserName}}</p>
                                            <p>{{item.Position}}</p>
                                        </div>
                                        <div>
                                         <span *ngIf="item.IsSubscribe == false" tappable (click)="focusHandle(item.UserID)"
                                               class="focus focus-blue">关注</span>
                                            <span *ngIf="item.IsSubscribe == true" tappable (click)="cancleFocusHandle(item.UserID)" class="focus noFocus-blue">已关注</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="space"></div>
                <div class="item" style="min-height: 290px">
                    <p>讲师评价
                        <span *ngIf="comment.teacher.length > 0" tappable (click)="goTeacherComment()" float-end
                              class="look">更多</span>
                        <span *ngIf="comment.teacher.length == 0" tappable (click)="goTeacherComment()"
                              class="focus focus-blue">去评价</span>
                    </p>
                    <div class="comment-list">
                        <div class="comment-item" *ngFor="let item of comment.teacher;">
                            <div class="first">
                                <div class="headPhoto">
                                    <img [src]="item.HeadPhoto" alt="">
                                </div>
                                <div style="text-align: left">
                                    <p class="badge">
                                        <span>
                                            {{item.UserName}}
                                        </span>
                                        <span *ngIf="item?.TitleInfo?.ForumTitle" class="forumTitle">
                                            {{item?.TitleInfo?.ForumTitle}}
                                        </span>
                                        <span class="badgeSpan" *ngFor="let badge of item?.Badges">
                                            <img [src]="badge.BadgeIcon">
                                            <span>{{badge.BadgeName.length > 4 ? badge.BadgeName.slice(0,4) + '...' : badge.BadgeName}}</span>
                                        </span>
                                    </p>
                                    <p>
                                        <span>{{item.CreateTime | date:'yyyy-MM-dd'}}</span>
                                        <span class="img-star">
                                            <ng-container *ngFor="let st of starList;let i = index">
                                                <span [ngClass]=" item.Score > i?'icon-star-fill':'icon-star' "
                                                      class="icon iconfont "></span>
                                            </ng-container>
                                        </span>
                                    </p>
                                </div>
                            </div>
                            <div class="last teacher">
                                <div class="Contents">
                                    {{item.Contents}}
                                </div>
                                <div class="item-teacher">
                                    <div>
                                        <img [src]="item.TeacherHeadPhoto || defalutPhoto" alt="">
                                    </div>
                                    <div>{{item.TeacherName}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="no-comment" *ngIf="comment.teacher.length == 0">
                        <ion-list text-center style="margin-top: 40px">
                            <img style="width: 60%;" src="./assets/imgs/no-data.png" alt="">
                            <p style="color: #666666;font-size: 13px">暂无讲师评价，快去发一条吧～</p>
                        </ion-list>
                    </div>
                </div>
            </ion-slide>
            <!--      评价      -->
            <ion-slide>
                <div class="item" style="min-height: 350px">
                    <p>{{product.detail?.TeachTypeName == "直播" ? "直播" : "课程"}}评价
                        <span *ngIf="comment.course.length > 0" tappable class="look" float-end
                              (click)="goCourseComment()">更多</span>
                        <span *ngIf="comment.course.length == 0" tappable class="focus-blue focus"
                              (click)="goCourseComment()">去评价</span>
                    </p>
                    <div class="comment-list">
                        <div class="comment-item" *ngFor="let item of comment.course;">
                            <div class="first">
                                <div class="headPhoto">
                                    <img [src]="item.HeadPhoto" alt="">
                                </div>
                                <div style="text-align: left">
                                    <p class="badge">
                                        <span>
                                            {{item.UserName}}
                                        </span>
                                        <span *ngIf="item?.TitleInfo?.ForumTitle" class="forumTitle">
                                            {{item?.TitleInfo?.ForumTitle}}
                                         </span>
                                        <span class="badgeSpan" *ngFor="let badge of item?.Badges">
                                                <img [src]="badge.BadgeIcon">
                                                <span>{{badge.BadgeName.length > 4 ? badge.BadgeName.slice(0,4) + '...' : badge.BadgeName}}</span>
                                        </span>
                                    </p>
                                    <p>
                                        <span>{{item.CreateTime | date:'yyyy-MM-dd'}}</span>
                                        <span class="img-star">
                                        <ng-container *ngFor="let st of starList;let i = index">
                                            <span [ngClass]=" item.Score > i?'icon-star-fill':'icon-star' "
                                                  class="icon iconfont "></span>
                                        </ng-container>
                                        </span>
                                    </p>
                                </div>
                            </div>
                            <div class="last teacher">
                                <div class="Contents">
                                    {{item.Contents}}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="no-comment" *ngIf="comment.course.length == 0">
                        <ion-list text-center style="margin-top: 40px">
                            <img style="width: 60%;" src="./assets/imgs/no-data.png" alt="">
                            <p style="color: #666666;font-size: 13px">
                                暂无{{product.detail?.TeachTypeName == "直播" ? "直播" : "课程"}}评价，快去发一条吧～
                            </p>
                        </ion-list>
                    </div>
                </div>

            </ion-slide>
            <!--      相关      -->
            <ion-slide>
                <div class="item" style="margin-bottom: 5rem">
                    <p>相关推荐</p>
                    <course-list [list]="learnList" (done)="goCourse($event)"></course-list>
                </div>
            </ion-slide>
        </ng-container>
    </ion-slides>
</ion-content>

<div *ngIf="signObj.isSign" class="sign">
    <img src="./assets/imgs/course/sign-success.png">
    <p>报名成功</p>
</div>
<div *ngIf="collectionObj.isCollection" class="collection">
    <img src="./assets/imgs/course/collection-success.png">
    <p>收藏成功</p>
</div>
