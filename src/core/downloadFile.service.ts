import {AlertController, LoadingController, Platform} from "ionic-angular";import {File} from "@ionic-native/file";import {FileTransfer, FileTransferObject} from "@ionic-native/file-transfer";import {Injectable} from "@angular/core";import {CommonService} from "./common.service";import {PhotoLibrary} from "@ionic-native/photo-library";@Injectable()export class DownloadFileService {    constructor(private platform: Platform,                public file: File,                public commonSer: CommonService,                public transfer: FileTransfer,                public alertCtrl: AlertController,                private photoLibrary: PhotoLibrary,                public loadingCtrl: LoadingController) {    }    downloadVideo(fileName, fileUrl) {        this.commonSer.alert(fileName);        this.commonSer.alert(fileUrl);        fileUrl = encodeURI(fileUrl);        fileName = encodeURI(fileName);        const uploadLoading = this.loadingCtrl.create({            content: '下载中...',            dismissOnPageChange: true,            enableBackdropDismiss: true,        });        const fileTransfer: FileTransferObject = this.transfer.create();        const imageLocation = fileUrl;        this.commonSer.alert("storageDirectory：" + this.file.dataDirectory);        fileTransfer.download(imageLocation, this.file.dataDirectory + fileName).then((entry) => {            this.photoLibrary.saveVideo(entry.toURL(), 'sgmw').then((success) => {                uploadLoading.dismiss();                this.commonSer.toast('视频下载成功')            }, (err) => {                this.commonSer.toast(err);            })        }, (error) => {            this.commonSer.toast('没有相册权限，请手动设置权限');        });        fileTransfer.onProgress(listener => {            let per = <any>(listener.loaded / listener.total) * 100;            per = Math.round(per * Math.pow(10, 2)) / Math.pow(10, 2)            uploadLoading.setContent('下载中...' + per + '%');        })    }    readFile() {    }}